---
layout: post
title: 日志采集工具比较
category: 日志采集
tags: 
    - 日志
    - 日志采集
    - ELK
    - Flume
description: 对当前流行的日志采集工具进行比较，分析各个工具的优缺点及架构。
---

# 日志采集工具比较

|                      | Flume                                                        | LogStash                                                     | Fluentd                                                      | Kafka                                          | Filebeta                                                     | Apache Chukwa |
| -------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------------------------------------- | ------------------------------------------------------------ | ------------- |
| 版本                 | 1.8.0                                                        | 6.3                                                          |                                                              |                                                | [6.3](https://www.elastic.co/guide/en/beats/filebeat/current/index.html) |               |
| 开发语言             | Java1.8                                                      | JRuby                                                        | CRuby                                                        | Java                                           | go                                                           |               |
| 简介                 |                                                              |                                                              | JSON作为数据格式。，易于解析                                 | 一个成熟的高性能消息队列                       | 轻量级的日志传输工具，支持对接logstash，elsearch。 性能非常好，部署简单 | 活跃度很低    |
| 成本                 | 开源                                                         | 免费                                                         | 开源                                                         | 开源                                           | 开源                                                         | 开源          |
| 架构                 | Agent由source，channel、sink组成。多个Agent可以组成调用链    | input、Filter、output组成。                                  | Input：完成输入数据的读取，由source部分配置  Parser：解析插件  Output：完成输出数据的操作，由match部分配置  Formatter：消息格式化的插件，属于filter类型  Buffer：缓存插件，用于缓存数据 |                                                | [Filebeta](https://www.cnblogs.com/louis2008/p/filebeat.html) |               |
| 容错性               | 优秀，消息发送事务和重试、下游崩溃时消息磁盘存档             | 假如 Logstash 节点发生故障，Logstash 会通过持久化队列来保证运行中的事件至少一次被送达（at-least-once delivery）。那些未被正常处理的消息会被送往死信队列（dead letter queue）以便做进一步处理。由于具备了这种吸收吞吐量的能力，现在您无需采用额外的队列层，Logstash 就能平稳度过高峰期 | 缓冲，负载平衡，超时和重试的支持。                           | 优秀                                           | 无                                                           |               |
| 负载均衡             | 支持sink端故障转移和负载均衡策略，[博客](https://blog.csdn.net/looklook5/article/details/40583815)。 | 支持                                                         | 支持                                                         | 支持                                           | 支持                                                         |               |
| 性能拓展             | 单个Agent配置多个sink提高性能                                |                                                              | 比较注重*性能*的地方采用C编写                                | 高性能，高吞吐量                               |                                                              |               |
| 功能拓展             | 1. 可以下载源代码拓展 2.支持开发插件                         | ruby拓展开发插件                                             |                                                              | 需要自己开发各种采集端                         |                                                              |               |
| 采集插件             | Exec、JMS、Directory、 Tail、Syslog、Http、自定义            | file、syslog、http、kafka、snmp、rabbitmq                    | 多种，支持SNMP                                               | 无                                             | 适用于文件日志的采集端，替代 logstash-input-file 。          |               |
| 缓存队列（缓存通道） | Memory、Jdbc、Kafka、File、自定义                            | 无，只发送至Redis或Kafka                                     | 支持缓存通道                                                 | 本身有一个很好的存储机制，支持内存和磁盘可靠性 |                                                              |               |
| 日志过滤             | 需要自定义采集插件实现日志过滤                               | 多种Filter插件：grok、json、drop、mutate、date、clone等，支持结构化解析文本、事件克隆、丢弃、字段转换 | 支持多种过滤插件和解析插件                                   | 无                                             |                                                              |               |
| 发送插件             | HDFS、Hive、File、Null、Hbase、Kafka、Http、自定义           | 多种                                                         | 多种                                                         | 无                                             |                                                              |               |
| 性能                 | [Flume1.4报告](https://www.cnblogs.com/yueyanyu/p/6972802.html) | [ **logstash及filebeat内存占用对比** ](https://blog.csdn.net/u010871982/article/details/79035317/)，[Logstash性能优化](http://chenlinux.com/2014/10/18/performance-testing-tunning-for-logstash-inputs-syslog/) |                                                              |                                                | [测试](https://www.jianshu.com/p/0802cf22a135)               |               |
| 缺点                 | 没有snmp插件                                                 | 性能和资源消耗较大。推荐logbeat采集数据，Logstash过滤日志。日志的容错性没有flume和fluentd号 | 输入输出插件没有logstash灵活。中文文档较少                   | 没有可用的采集插件，更多的是用作消息缓存和转发 | 插件较少                                                     |               |
| 安装文档             |                                                              |                                                              |                                                              |                                                |                                                              |               |

### Flume **架构** 

多个Agent连接形成Agent链： 

![image](https://tva4.sinaimg.cn/large/007S2YVMgy1gdzim9qz1ej30hn0bt408.jpg) 

多路Agent:

 

![image](https://tva3.sinaimg.cn/large/007S2YVMgy1gdzin6f68fj30hc0a4gmo.jpg)

实现load balance功能：

 

![img](https://tvax1.sinaimg.cn/large/007S2YVMgy1gdzino1ly0j30jg09mtb2.jpg)



### FileBeta

![img](https://tva3.sinaimg.cn/large/007S2YVMgy1gdzio8robej30fe0c2mye.jpg) 